# ADR-004 — Regras de Enforcement da Arquitetura Hexagonal

> [Versão em inglês](../en/ADR-004.md)

## Status
Accepted

## Data
2026-02-22

## Contexto

O TripLedger utiliza Arquitetura Hexagonal. Regras de enforcement são necessárias para:

- Manter limites limpos entre módulos
- Evitar acoplamento entre módulos
- Garantir pureza do domínio
- Servir como referência para geração de código assistida por IA

---

## Decisão

1. **Camada de Domínio**
   - Sem dependências de frameworks
   - Contém entidades, objetos de valor, exceções, serviços de domínio
   - Contém todas as regras de negócio

2. **Camada de Aplicação**
   - Define portas de entrada/saída
   - Implementa casos de uso
   - Coordena operações do domínio
   - Pode conter DTOs

3. **Camada de Adaptadores**
   - Implementa portas
   - Controllers REST (entrada)
   - Repositórios Mongo (saída)
   - Integrações externas
   - Não contém regras de negócio

4. **Comunicação entre Módulos**
   - Deve ocorrer apenas por Portas
   - Nenhum módulo acessa adaptadores ou domínio de outro módulo diretamente

5. **Testes**
   - Domínio: apenas testes unitários
   - Casos de uso: testes unitários/integrados usando Portas
   - Adaptadores: testes de integração com banco

---

## Justificativa

Enforcement dos limites hexagonais garante:

- Separação clara de responsabilidades
- Manutenibilidade facilitada
- Extração futura para microserviços
- Código gerado por IA segue disciplina arquitetural

---

## Consequências

- Propriedade clara dos módulos
- Acoplamento acidental mínimo
- Código manutenível, testável e extensível

