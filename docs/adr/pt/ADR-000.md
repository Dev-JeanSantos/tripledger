# ADR-000 — Definição do Problema e Princípios Norteadores

> [Versão em inglês](../en/ADR-000.md)

## Status
Accepted

## Data
2026-02-22

## Sistema
TripLedger

---

## Contexto

O **TripLedger** é uma solução backend projetada para apoiar usuários na organização de viagens individuais ou em grupo, com foco em controle financeiro e organização estruturada.

Usuários que organizam viagens frequentemente enfrentam dificuldades como:

- Falta de controle sobre orçamento total
- Dificuldade em dividir despesas entre participantes
- Falta de centralização de checklist e planejamento
- Dificuldade em acompanhar status da viagem (planejada, ativa, finalizada)
- Perda de informações importantes durante o planejamento

Ferramentas existentes no mercado geralmente:

- São excessivamente complexas
- Não integram orçamento + checklist + despesas de forma simples
- Não são pensadas para colaboração objetiva e prática

---

## Problema

Como permitir que usuários organizem viagens individuais ou em grupo com controle eficiente de orçamento, despesas e checklist, garantindo regras claras de negócio e possibilidade de evolução arquitetural futura?

---

## Decisão

O TripLedger será implementado utilizando:
- **Kotlin**
- **Spring Boot**
- **MongoDB**

O projeto tem como objetivo servir como artefato profissional de portfólio.

O **TripLedger** será uma API backend responsável por:

1. Gerenciar viagens individuais ou compartilhadas.
2. Controlar orçamento previamente definido.
3. Registrar despesas associadas à viagem.
4. Permitir gerenciamento de checklist.
5. Aplicar regras claras de negócio relacionadas a:
   - Orçamento
   - Datas
   - Controle de acesso
   - Estados da viagem

A API será:

- Stateless
- Orientada a recursos (RESTful)
- Versionada
- Projetada para escalabilidade horizontal

---

## Regras de Negócio Fundamentais

### 1. Viagem

- Uma viagem possui um dono (owner).
- Uma viagem pode ter membros convidados.
- Uma viagem possui status:
  - `PLANNED`
  - `ACTIVE`
  - `FINISHED`
  - `CANCELED`

### 2. Datas

- `endDate` deve ser maior que `startDate`.
- Uma viagem não pode ser marcada como `ACTIVE` antes da data de início.
- Uma viagem não pode ser modificada se estiver `FINISHED` ou `CANCELED`.

### 3. Orçamento

- Toda viagem pode ter orçamento opcional.
- Se houver orçamento definido:
  - A soma das despesas deve ser calculada dinamicamente.
  - O sistema deve sinalizar quando ultrapassar 80% do orçamento.
  - O sistema deve sinalizar quando ultrapassar 100% do orçamento.
- O sistema não bloqueia a ultrapassagem do orçamento (decisão consciente).

### 4. Despesas

- Toda despesa pertence a uma única viagem.
- Apenas o owner ou membros podem registrar despesas.
- Não é permitido registrar despesas em viagens `CANCELED` ou `FINISHED`.

### 5. Checklist

- Itens podem ser criados apenas em viagens `PLANNED` ou `ACTIVE`.
- Itens podem ser marcados como concluídos.
- Itens não podem ser modificados se a viagem estiver `FINISHED` ou `CANCELED`.

---

## Princípios Norteadores da Solução

1. O domínio do negócio tem prioridade sobre tecnologia.
2. Regras devem estar no domínio, não no controller.
3. A arquitetura deve permitir escalabilidade futura.
4. Observabilidade deve ser considerada desde o início.
5. Segurança deve ser parte da arquitetura, não um complemento.
6. Decisões arquiteturais devem ser registradas via ADR.

---

## Uso de IA

No contexto do TripLedger, a IA pode ser utilizada como ferramenta de apoio para:

- Refinamento de regras de negócio
- Sugestão de modelagem de dados
- Sugestão de índices
- Geração inicial de código
- Revisão de qualidade

Porém:

- A IA não é autoridade do domínio.
- Esta ADR é a fonte oficial de verdade.
- Toda sugestão de IA deve ser validada contra esta ADR.

---

## Consequências

- O TripLedger terá foco real em regras de negócio.
- O projeto não será apenas um CRUD.
- A arquitetura será guiada por domínio.
- A documentação será parte integrante do projeto.
- Toda evolução futura deve respeitar esta definição de problema.
